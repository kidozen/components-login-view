module.exports = 'var LoginController = function (view, model) {\n    var self = this;\n    if (!view) view = View($);\n    if (!model) model = new Model();\n\n    this.loadSignin = function () {\n        if (window.localStorage) {\n            var get = localStorage.getItem.bind(localStorage);\n            options.username    = get("username")    || options.username;\n            options.password    = get("password")    || options.password;\n            options.application = get("application") || options.application;\n            options.marketplace = get("marketplace") || options.marketplace;\n        }\n        // populate Sign In Page with cached values\n        view.login.load(options);\n        if (options.username &&\n            options.password &&\n            options.application &&\n            options.marketplace) {\n            controller.signin();\n        } else {\n            view.login.show();\n        }\n    };\n\n    this.signin = function () {\n        var username = view.login.username();\n        var password = view.login.password();\n        var application = view.login.application();\n        var marketplace = view.login.marketplace();\n\n        model.authenticate(username, password, application, marketplace)\n            .done(function () {\n                self.loadHome();\n                //authentication settings are valid, so store them\n                if (window.localStorage) {\n                    localStorage.setItem("username", username);\n                    localStorage.setItem("password", password);\n                    localStorage.setItem("application", application);\n                    localStorage.setItem("marketplace", marketplace);\n                }\n            })\n            .fail(function () {\n                view.alert("An error occurred while authenticating the user");\n            });\n    };\n\n    this.signout = function () {\n        model.signout();\n        view.login.show();\n    };\n};';